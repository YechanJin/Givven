<!DOCTYPE html>
<html>

<head>
   <title>GIVVEN(기쁜)</title>
   <meta charset="utf-8">
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
   <link rel="stylesheet" href="public/css/normal_donation_main_style.css">
</head>

<body>
   <div id="navbar">
      <div id='top_navbar'>
         <div id='logo'>
            <img src='public/images/logo.png'>
         </div>
         <ul id='menu'>
            <li><a href='log_in.html'><b>로그인</b></a></li>
            <li><a href='sign_up.html'><b>회원가입</b></a></li>
         </ul>
      </div>
      <div id="second_navbar">
         <ul id='menu'>
            <li><a href='normal_donation_main.html' id="go_donate"><b>기부하기</b></a></li>
            <li><a href='normal_shop_main.html' id="go_purchase"><b>상점가기</b></a></li>
         </ul>
      </div>
   </div>
   <div id="third_bar">
      <div id="recommand_header"><b>이런 캠페인은 어때요?</b></div>
      <div id="search-bar">
         <input type="text" name="search" class="search-keyword" placeholder="어떤 기부를 원하시나요?">
         <button type="submit" class="submit-btn"><img src='public/images/search_btn.png'></button>
      </div>
   </div>

   <div id="carouselIndicators" class="carousel slide" data-ride="carousel">
      <ol class="carousel-indicators">
      </ol>

      <div class="carousel-inner">
      </div>
   </div>

   <div id=container>
      <div id=allCampaigns>
         <a href='#'><b>모든 캠페인</b></a>
         <div class="card_list">
         </div>
      </div>
   </div>



   <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
   </script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
   </script>
   <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
   </script>
   <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

   <script>
      var current_campaign_list;
      var i;

      $.ajax({
         type: 'GET',
         url: "http://ec2-18-191-173-110.us-east-2.compute.amazonaws.com:8080/campaign/campaigns/ing",
         xhrFields: {
            withCredentials: true
         },
      }).success(function (response) {
         console.log(response);
         current_campaign_list = response.data;
         console.log(current_campaign_list);

         if (current_campaign_list.campaigns.length == 0) {
            $("#carouselIndicators").append("<p class = " + "no_data" + ">모금중인 캠페인이 없어요..</p>");
         } else {
            i = 0;
            var imgurl;
            while (i < current_campaign_list.campaigns.length) {imgurl = "http://ec2-18-191-173-110.us-east-2.compute.amazonaws.com:8080"+current_campaign_list.campaigns[i].title_img;
               if (i === 0) {
                  $(".carousel-indicators").append(
                     '<li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>'
                  );
                  $(".carousel-inner").append(
                     '<div class="carousel-item no1 active">'+
                     '<button class="items" alt="First slide" id="first">'+
                     '<h2>'+current_campaign_list.campaigns[i].name+'</h2>'+
                     '<p>현재 '+current_campaign_list.campaigns[i].current_money+' 포인트! '+
                         '목표 모금 금액까지 '+
                         (current_campaign_list.campaigns[i].dest_money - current_campaign_list.campaigns[i].current_money)+
                         '포인트 남았습니다!</p>'+
                     '<div class="progress">'+
                     '<div class="progress-bar progress-bar-striped" role="progressbar" style="width: '+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%"'+
                     'aria-valuenow="'+(current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'" aria-valuemin="0" aria-valuemax="100">'+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%달성</div>'+
                     '</div>'+
                     '</button>'+
                     '</div>'
                  );
                  imgurl = "http://ec2-18-191-173-110.us-east-2.compute.amazonaws.com:8080"+current_campaign_list.campaigns[i].title_img;
                  $("#first").css("background-image", imgurl);
               } else if (i === 1) {
                  $(".carousel-indicators").append(
                     '<li data-target="#carouselIndicators" data-slide-to="1"></li>'
                  );
                  $(".carousel-inner").append(
                     '<div class="carousel-item no2">'+
                     '<button class="items" alt="Second slide" id="second">'+
                     '<h2>'+current_campaign_list.campaigns[i].name+'</h2>'+
                     '<p>현재 '+current_campaign_list.campaigns[i].current_money+' 포인트! '+
                         '목표 모금 금액까지 '+
                         (current_campaign_list.campaigns[i].dest_money - current_campaign_list.campaigns[i].current_money)+
                         '포인트 남았습니다!</p>'+
                     '<div class="progress">'+
                     '<div class="progress-bar progress-bar-striped" role="progressbar" style="width: '+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%"'+
                     'aria-valuenow="'+(current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'" aria-valuemin="0" aria-valuemax="100">'+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%달성</div>'+
                     '</div>'+
                     '</button>'+
                     '</div>'
                  );
                  imgurl = "http://ec2-18-191-173-110.us-east-2.compute.amazonaws.com:8080"+current_campaign_list.campaigns[i].title_img;
                  $("#second").css("background-image", imgurl);
               } else if (i === 2) {
                  $(".carousel-indicators").append(
                     '<li data-target="#carouselIndicators" data-slide-to="2"></li>'
                  );
                  $(".carousel-inner").append(
                     '<div class="carousel-item no3">'+
                     '<button class="items" alt="Third slide" id="third">'+
                     '<h2>'+current_campaign_list.campaigns[i].name+'</h2>'+
                     '<p>현재 '+current_campaign_list.campaigns[i].current_money+' 포인트! '+
                         '목표 모금 금액까지 '+
                         (current_campaign_list.campaigns[i].dest_money - current_campaign_list.campaigns[i].current_money)+
                         '포인트 남았습니다!</p>'+
                     '<div class="progress">'+
                     '<div class="progress-bar progress-bar-striped" role="progressbar" style="width: '+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%"'+
                     'aria-valuenow="'+(current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'" aria-valuemin="0" aria-valuemax="100">'+
                     (current_campaign_list.campaigns[i].current_money/current_campaign_list.campaigns[i].dest_money*100)+'%달성</div>'+
                     '</div>'+
                     '</button>'+
                     '</div>'
                  );
                  
                  $("#third").css("background-image", imgurl);
               }

               $(".card_list").append(
                  "<div class='card'>" +
                  "<img src='" + imgurl + "'>" +
                  "<div class='menu'>" +
                  "<h3>" + current_campaign_list.campaigns[i].name + "</h3>" +
                  "<p>" + current_campaign_list.campaigns[i].current_money + "p / " + current_campaign_list
                  .campaigns[i].dest_money + "p</p>" +
                  "<div class='progress'>" +
                  "<div class='progress-bar progress-bar-striped' role='progressbar' style='width: " +
                  current_campaign_list.campaigns[i].current_money / current_campaign_list.campaigns[i]
                  .dest_money * 100 + "%'" +
                  "aria-valuenow='" + current_campaign_list.campaigns[i].current_money /
                  current_campaign_list.campaigns[i].dest_money * 100 +
                  "' aria-valuemin='0' aria-valuemax='100'>" + current_campaign_list.campaigns[i]
                  .current_money / current_campaign_list.campaigns[i].dest_money * 100 + "%</div>" +
                  "</div>" +
                  "</div>" +
                  "</div>");

               i = i + 1;
            }
            $(".card_list").append('<div class="clearfix" style="clear: left"></div>');
         }
      });
   </script>

</body>

</html>